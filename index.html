<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EmpowerTours</title>
    <link rel="icon" type="image/x-icon" href="/public/favicon.ico">
    <style>
        /* General page styling */
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            color: #333;
            background-color: #f4f4f4;
            background-image: url('https://raw.githubusercontent.com/EmpowerTours/version1/main/public/IMG_3466.jpg');
            background-size: cover;
            background-position: center bottom;
            padding-top: 80px; /* Space for sticky header */
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
            background-color: rgba(255, 255, 255, 0.9); /* Semi-transparent for readability */
            padding: 20px;
            border-radius: 10px;
        }
        h1 {
            color: #FF4500;
            font-family: 'Arial Black', sans-serif;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-size: 2.5em;
        }
        p {
            font-size: 1.2em;
            max-width: 800px;
            margin: 0 auto;
        }
        /* Sticky Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 10px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 1000;
        }
        .header img {
            height: 40px;
            border-radius: 5px;
        }
        .header-nav {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .header-nav a {
            color: #FF4500;
            text-decoration: none;
            font-weight: bold;
            font-size: 1em;
            padding: 5px 10px;
            transition: background-color 0.3s, color 0.3s;
        }
        .header-nav a:hover {
            background-color: #FF4500;
            color: #fff;
            border-radius: 5px;
        }
        /* Hamburger Menu */
        .hamburger {
            display: none;
            font-size: 24px;
            background: none;
            border: none;
            color: #FF4500;
            cursor: pointer;
            padding: 5px 10px;
            transition: transform 0.3s;
        }
        .hamburger:hover {
            transform: scale(1.2);
        }
        .nav-menu {
            display: flex;
        }
        .nav-menu.active {
            display: flex;
            flex-direction: column;
            width: 100%;
            background-color: #fff;
            position: absolute;
            top: 60px;
            left: 0;
            padding: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transform: translateY(0);
            transition: transform 0.3s ease-in-out;
        }
        .nav-menu:not(.active) {
            transform: translateY(-100%);
        }
        /* Google Translate styling */
        .goog-te-banner-frame { display: none !important; }
        .goog-te-gadget { font-size: 0px !important; }
        .goog-te-combo { margin: 0px !important; font-size: 14px !important; }
        .skiptranslate { display: none !important; }
        body { top: 0px !important; }
        #google_translate_element {
            display: inline-block;
        }
        /* Wallet Connect */
        button {
            padding: 12px 24px;
            font-size: 16px;
            cursor: pointer;
            background-color: #28a745;
            color: #000;
            border: none;
            border-radius: 5px;
            margin: 10px;
        }
        button:hover {
            background-color: #218838;
        }
        #status {
            margin-top: 20px;
            font-size: 18px;
            color: #ff4;
        }
        #error {
            color: #dc3545;
            margin-top: 10px;
        }
        #txHash {
            word-break: break-all;
            margin-top: 10px;
            font-size: 14px;
        }
        #instructions {
            margin-top: 15px;
            font-size: 16px;
            color: #ff4;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        /* Balance Checker */
        .balance-checker {
            margin: 20px 0;
            text-align: center;
        }
        .balance-checker button {
            background-color: #FF4500;
            color: #fff;
        }
        .balance-checker button:hover {
            background-color: #FFA500;
        }
        .balance-checker p {
            font-size: 1em;
            margin-top: 10px;
            color: #333;
        }
        /* SVG Map */
        .map-container {
            margin: 20px auto;
            max-width: 600px;
            position: relative;
        }
        svg {
            width: 100%;
            height: auto;
            background-color: #e0f7fa;
            border-radius: 10px;
        }
        .climb-marker {
            fill: #FF4500;
            cursor: pointer;
            transition: transform 0.3s;
        }
        .climb-marker:hover {
            transform: scale(1.5);
        }
        .tooltip {
            position: absolute;
            background-color: #fff;
            border: 1px solid #FF4500;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.9em;
            display: none;
            pointer-events: none;
        }
        /* Badge styling */
        .badges {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        .badges a {
            display: inline-block;
        }
        /* Collapsible sections */
        details {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin: 10px 0;
            text-align: left;
        }
        summary {
            cursor: pointer;
            font-weight: bold;
            color: #FF4500;
        }
        /* Table styling */
        .table-container {
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #FF4500;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        /* Tech stack badges */
        .tech-stack {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }
        /* List styling for user journey */
        ol.gradient-list {
            list-style-type: none;
            padding: 0;
        }
        ol.gradient-list li {
            background: linear-gradient(to right, #FF4500, #FFA500);
            color: white;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
        }
        /* Links */
        a {
            color: #FF4500;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        /* Responsive Design Tweaks */
        @media (max-width: 1024px) {
            body {
                padding: 10px;
                padding-top: 60px; /* Reduced header height */
            }
            h1 {
                font-size: 2em;
            }
            p {
                font-size: 1em;
            }
            .container {
                max-width: 100%;
            }
            .header {
                flex-wrap: wrap;
                align-items: center;
            }
            .header img {
                height: 30px;
            }
            .hamburger {
                display: block;
            }
            .nav-menu {
                display: none;
                flex-direction: column;
                width: 100%;
                background-color: #fff;
                position: absolute;
                top: 60px;
                left: 0;
                padding: 10px;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .nav-menu.active {
                display: flex;
            }
            .header-nav {
                flex-direction: column;
                gap: 10px;
            }
            .header-nav a {
                font-size: 0.9em;
            }
            .badges {
                flex-direction: column;
                align-items: center;
            }
            .tech-stack {
                flex-direction: column;
                align-items: center;
            }
            .table-container {
                overflow-x: auto;
            }
            table {
                font-size: 0.9em;
            }
            th, td {
                padding: 8px;
            }
            .map-container {
                max-width: 100%;
            }
        }
        @media (min-width: 1025px) {
            .header-nav {
                flex-direction: row;
                gap: 15px;
            }
            .nav-menu {
                display: flex;
            }
            .hamburger {
                display: none;
            }
        }
        @media (max-width: 480px) {
            h1 {
                font-size: 1.5em;
            }
            p {
                font-size: 0.9em;
            }
            .header img {
                height: 25px;
            }
            .header-nav a {
                font-size: 0.8em;
            }
            .badges img {
                width: 100%;
                max-width: 200px;
            }
            .tech-stack img {
                width: 100%;
                max-width: 150px;
            }
        }
    </style>
</head>
<body>
    <!-- Sticky Header -->
    <div class="header">
        <div style="display: flex; align-items: center; gap: 10px;">
            <img src="https://raw.githubusercontent.com/EmpowerTours/version1/main/public/IMG_3466.jpg" alt="EmpowerTours Logo">
            <button class="hamburger" onclick="toggleMenu()">☰</button>
            <div class="nav-menu" id="nav-menu">
                <div class="header-nav">
                    <a href="#wallet-connect">Wallet Connect</a>
                    <a href="#quick-start">Quick Start</a>
                    <a href="#technologies">Technologies</a>
                    <a href="#commands">Commands</a>
                    <a href="#fees">Fees</a>
                    <a href="#future">Future Features</a>
                </div>
            </div>
        </div>
        <div id="google_translate_element"></div>
    </div>

    <div class="container">
        <!-- Wallet Connect Section -->
        <h1 id="wallet-connect">EmpowerTours Wallet Connect</h1>
        <button id="connectButton">Connect Wallet</button>
        <div id="status">Please connect your wallet to Monad Testnet (chainId: 10143).</div>
        <div id="instructions">On mobile, open this link in the MetaMask app's browser (Menu > Browser) to connect. If you see a chain ID mismatch, go to MetaMask Settings > Networks, remove all Monad Testnet entries, and reconnect. Network details: Chain ID: 10143, RPC: https://testnet-rpc.monad.xyz, Explorer: https://testnet.monadexplorer.com. After connecting, use /createprofile, /buildaclimb, or /buyTours in Telegram.</div>
        <div id="error"></div>
        <div id="txHash"></div>

        <!-- Balance Checker -->
        <div class="balance-checker">
            <button onclick="checkBalance()">Check $MON/$TOURS Balance</button>
            <p id="balance-result">Click to check your balance.</p>
        </div>

        <!-- Interactive Map -->
        <h2>Climb Locations</h2>
        <div class="map-container">
            <svg viewBox="0 0 1000 500" preserveAspectRatio="xMidYMid meet">
                <rect x="0" y="0" width="1000" height="500" fill="#e0f7fa" />
                <!-- Simplified world map outline -->
                <path d="M100,100 C200,50 300,150 400,100 S600,50 700,100 900,150 900,300 800,400 600,400 400,350 300,400 200,350 100,300 Z" fill="#c8e6c9" stroke="#000" stroke-width="2" />
                <!-- Climb markers (populated by JS) -->
                <g id="climb-markers"></g>
            </svg>
            <div class="tooltip" id="tooltip"></div>
        </div>

        <!-- README Content -->
        <img src="https://raw.githubusercontent.com/EmpowerTours/version1/main/public/IMG_3466.jpg" alt="EmpowerTours Logo" width="300" style="border-radius: 15px; box-shadow: 0 4px 8px rgba(0,0,0,0.2);">
        <h1>EmpowerTours</h1>
        <p>🧗 Web3-Powered Rock Climbing Adventures & Community – Conquer Peaks, Earn Tokens, Build Routes on Monad Blockchain!</p>

        <!-- Badges -->
        <div class="badges">
            <a href="https://monad.xyz"><img src="https://img.shields.io/badge/Blockchain-Monad%20Testnet-orange?style=for-the-badge&logo=ethereum" alt="Monad Testnet"></a>
            <a href="https://t.me/empowertoursbot"><img src="https://img.shields.io/badge/Telegram-Bot-blue?style=for-the-badge&logo=telegram" alt="Telegram Bot"></a>
            <a href="https://t.me/empowertourschat"><img src="https://img.shields.io/badge/Chat-Join%20Now-green?style=for-the-badge&logo=telegram" alt="Community Chat"></a>
            <a href="LICENSE"><img src="https://img.shields.io/badge/License-Proprietary-red?style=for-the-badge" alt="License"></a>
            <a href="mailto:earvin.gallardo@csecsystems.com"><img src="https://img.shields.io/badge/Invest-Open%20to%20Angels-yellow?style=for-the-badge&logo=bitcoin" alt="Open to Investors"></a>
        </div>

        <!-- Quick Start -->
        <h2 id="quick-start">🚀 Quick Start</h2>
        <p>Launch the bot: <a href="https://t.me/AI_RobotExpert_bot">@AI_RobotExpert_bot</a><br>
        Join the community: <a href="https://t.me/empowertourschat">@empowertourschat</a><br>
        Faucet $MON: <a href="https://testnet.monad.xyz/faucet">Monad Faucet</a></p>

        <!-- Monad Testnet Setup -->
        <h2>Setting Up Monad Testnet on MetaMask</h2>
        <p>If you're new to Monad, here's a quick guide to configure it on MetaMask. This is essential for interacting with EmpowerTours, as the app runs on Monad Testnet.</p>
        <p><strong>Quick Summary of Monad Blockchain:</strong><br>
        Monad is a high-performance, EVM-compatible Layer-1 blockchain aiming for 10,000 transactions per second (TPS) with 1-second block times. It optimizes Ethereum's architecture through pipelined execution, superscalar design, and MonadDb for faster state access, making it suitable for DeFi, gaming, and dApps requiring speed. Learn more at the <a href="https://monad.xyz">official website</a> or <a href="https://docs.monad.xyz">documentation</a>.</p>
        <p><strong>Resources:</strong><br>
        - Official Guide: <a href="https://docs.monad.xyz/guides/add-monad-to-wallet/metamask">Add Monad to MetaMask</a><br>
        - One-Click Add: <a href="https://chainlist.org/chain/10143">ChainList - Monad Testnet</a><br>
        - Beginner Guide: <a href="https://help.magiceden.io/en/articles/10583721-introducing-monad-on-magic-eden-a-beginner-s-guide">Magic Eden Monad Guide</a><br>
        - Faucet: <a href="https://testnet.monad.xyz/faucet">Monad Faucet</a></p>
        <p><strong>Step-by-Step Setup:</strong></p>
        <ol>
            <li>Open MetaMask and click on the network dropdown at the top.</li>
            <li>Select "Add Network" > "Add a network manually".</li>
            <li>Enter the following details:
                <ul>
                    <li><strong>Network Name:</strong> Monad Testnet</li>
                    <li><strong>New RPC URL:</strong> https://testnet-rpc.monad.xyz</li>
                    <li><strong>Chain ID:</strong> 10143</li>
                    <li><strong>Currency Symbol:</strong> MON</li>
                    <li><strong>Block Explorer URL:</strong> https://testnet.monadexplorer.com</li>
                </ul>
            </li>
            <li>Click "Save".</li>
            <li>Switch to the network and request testnet $MON from the faucet.</li>
        </ol>
        <p>For visual steps, check the <a href="https://docs.monad.xyz/guides/add-monad-to-wallet/metamask">official Monad docs</a> which include screenshots of the process (e.g., adding custom network, entering RPC details, saving, and verifying assets).</p>

        <!-- Why EmpowerTours -->
        <details id="why-empowertours">
            <summary><b>🌟 Why EmpowerTours?</b></summary>
            <div style="background-color: #f9f9f9; padding: 15px; border-radius: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                <ul>
                    <li><strong>Journal Climbs 🗒️:</strong> Log ascents with photos, GPS, notes – earn 5 $TOURS per entry!</li>
                    <li><strong>Build & Buy Routes 🪨:</strong> Create/share custom climbs (10 $TOURS cost to contract) or purchase (10 $TOURS to creator).</li>
                    <li><strong>Tournaments 🏆:</strong> Compete for $TOURS pots – entry fees build the prize!</li>
                    <li><strong>Web3 Incentives 💰:</strong> Transparent fees, on-chain events, Monad speed.</li>
                    <li><strong>Community Vibes 👥:</strong> Telegram chat for tips, meets, collabs.</li>
                </ul>
            </div>
        </details>

        <!-- Technologies & Stack -->
        <h2 id="technologies">🔧 Technologies & Stack</h2>
        <div class="tech-stack">
            <img src="https://img.shields.io/badge/Python-3.12-blue?style=flat-square&logo=python" alt="Python">
            <img src="https://img.shields.io/badge/FastAPI-0.100-green?style=flat-square&logo=fastapi" alt="FastAPI">
            <img src="https://img.shields.io/badge/Web3.py-6.0-orange?style=flat-square&logo=ethereum" alt="Web3.py">
            <img src="https://img.shields.io/badge/PostgreSQL-15-blue?style=flat-square&logo=postgresql" alt="PostgreSQL">
            <img src="https://img.shields.io/badge/Solidity-0.8-black?style=flat-square&logo=solidity" alt="Solidity">
            <img src="https://img.shields.io/badge/Telegram-Bot_API-cyan?style=flat-square&logo=telegram" alt="Telegram">
        </div>
        <p><strong>Contract Addresses (Monad Testnet):</strong></p>
        <ul>
            <li><strong>EmpowerTours:</strong> <code>0xB69D011496B7d7a5e5B3D0021dBF4468b0050AB6</code></li>
            <li><strong>$TOURS Token:</strong> <code>0x2Da15A8B55BE310A7AB8EB0010506AB30CD6CBcf</code></li>
            <li><strong>Owner Wallet:</strong> <code>0x5fE8373C839948bFCB707A8a8A75A16E2634A725</code> (90% fees for dev/ops)</li>
            <li><strong>Legacy Wallet:</strong> <code>0x3de6FCEECd5d05363D80A77963Edd3787c96E593</code> (10% fees for maintenance)</li>
            <li><strong>RPC:</strong> <a href="https://testnet-rpc.monad.xyz">https://testnet-rpc.monad.xyz</a></li>
            <li><strong>Explorer:</strong> <a href="https://testnet.monadexplorer.com">https://testnet.monadexplorer.com</a></li>
        </ul>

        <!-- How It Works -->
        <h2>📖 How It Works</h2>
        <details id="user-journey">
            <summary><b>🧑‍💻 User Journey (Interactive Flow)</b></summary>
            <ol class="gradient-list">
                <li>/start – Welcome & join chat 🏞️</li>
                <li>/connectwallet – Link MetaMask (Chain ID 10143)</li>
                <li>/createprofile – Sign tx (1 $MON fee, earn 1 $TOURS)</li>
                <li>Explore: /journal, /buildaclimb, /purchaseclimb...</li>
                <li>Tournaments: Create/Join/End for $TOURS pots</li>
            </ol>
        </details>
        <details id="backend-flow">
            <summary><b>🔗 Backend & Blockchain Flow</b></summary>
            <ul>
                <li><strong>Bot:</strong> Processes commands, builds unsigned tx.</li>
                <li><strong>API:</strong> Handles wallet/tx submission.</li>
                <li><strong>DB:</strong> Sessions, pendings (expires 30min).</li>
                <li><strong>Monitoring:</strong> Events polled every 30s; notifies chat/users.</li>
                <li><strong>Fees in Tournaments:</strong> 100% of entry fees ($TOURS) to pot; on end, 5% fee to legacy wallet (maintenance), 95% to winner.</li>
            </ul>
        </details>

        <!-- Commands & Usage -->
        <h2 id="commands">📋 Commands & Usage</h2>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Command</th>
                        <th>Description</th>
                        <th>Cost/Reward</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>/start</td>
                        <td>Welcome message</td>
                        <td>Free</td>
                    </tr>
                    <tr>
                        <td>/tutorial</td>
                        <td>Setup guide</td>
                        <td>Free</td>
                    </tr>
                    <tr>
                        <td>/connectwallet</td>
                        <td>Link wallet</td>
                        <td>Free</td>
                    </tr>
                    <tr>
                        <td>/createprofile</td>
                        <td>Create profile</td>
                        <td>1 $MON (earn 1 $TOURS)</td>
                    </tr>
                    <tr>
                        <td>/buyTours <amount></td>
                        <td>Buy $TOURS</td>
                        <td>1 $MON per $TOURS</td>
                    </tr>
                    <tr>
                        <td>/sendTours <recipient> <amount></td>
                        <td>Send $TOURS</td>
                        <td>Gas only</td>
                    </tr>
                    <tr>
                        <td>/journal <entry></td>
                        <td>Log climb</td>
                        <td>Earn 5 $TOURS</td>
                    </tr>
                    <tr>
                        <td>/comment <id> <comment></td>
                        <td>Comment on journal</td>
                        <td>0.1 $MON</td>
                    </tr>
                    <tr>
                        <td>/buildaclimb <name> <difficulty></td>
                        <td>Create route</td>
                        <td>10 $TOURS (to contract)</td>
                    </tr>
                    <tr>
                        <td>/purchaseclimb <id></td>
                        <td>Buy route</td>
                        <td>10 $TOURS (to creator)</td>
                    </tr>
                    <tr>
                        <td>/findaclimb</td>
                        <td>List climbs</td>
                        <td>Free</td>
                    </tr>
                    <tr>
                        <td>/viewclimb <id></td>
                        <td>Climb details</td>
                        <td>Free</td>
                    </tr>
                    <tr>
                        <td>/mypurchases</td>
                        <td>Your purchases</td>
                        <td>Free</td>
                    </tr>
                    <tr>
                        <td>/journals</td>
                        <td>List entries</td>
                        <td>Free</td>
                    </tr>
                    <tr>
                        <td>/viewjournal <id></td>
                        <td>Entry + comments</td>
                        <td>Free</td>
                    </tr>
                    <tr>
                        <td>/createtournament <fee></td>
                        <td>Start tournament</td>
                        <td>Free (gas)</td>
                    </tr>
                    <tr>
                        <td>/tournaments</td>
                        <td>List tournaments</td>
                        <td>Free</td>
                    </tr>
                    <tr>
                        <td>/jointournament <id></td>
                        <td>Join</td>
                        <td>Entry fee $TOURS (to pot)</td>
                    </tr>
                    <tr>
                        <td>/endtournament <id> <winner></td>
                        <td>End (owner)</td>
                        <td>Free; 95% pot to winner, 5% fee to legacy</td>
                    </tr>
                    <tr>
                        <td>/balance</td>
                        <td>Check balances</td>
                        <td>Free</td>
                    </tr>
                    <tr>
                        <td>/help</td>
                        <td>Command list</td>
                        <td>Free</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Costs, Fees & Transparency -->
        <h2 id="fees">💰 Costs, Fees & Transparency</h2>
        <details id="fee-breakdown">
            <summary><b>📊 Fee Breakdown (All On-Chain)</b></summary>
            <ul>
                <li><strong>Profiles/Comments/Buy $TOURS:</strong> 90% to OWNER_ADDRESS (dev/ops), 10% to LEGACY_ADDRESS (maintenance).</li>
                <li><strong>Build Climbs:</strong> 10 $TOURS to contract (for platform/rewards).</li>
                <li><strong>Purchase Climbs:</strong> 100% (10 $TOURS) to creator.</li>
                <li><strong>Tournaments:</strong> 100% of entry fees ($TOURS) to pot; on end, 5% fee to legacy wallet (maintenance), 95% to winner.</li>
                <li><strong>Rewards:</strong> From contract pool (prefunded).</li>
                <li><strong>Gas:</strong> ~0.001-0.01 $MON/tx.</li>
                <li><strong>Audit:</strong> Explorer links; events for all actions.</li>
            </ul>
        </details>
        <details id="response-times">
            <summary><b>⚡ Response Times</b></summary>
            <ul>
                <li><strong>Commands:</strong> 1-5s</li>
                <li><strong>Tx Confirm:</strong> 1-10s (Monad)</li>
                <li><strong>Events:</strong> ~30s poll</li>
                <li><strong>Overall:</strong> <10s typical</li>
            </ul>
        </details>

        <!-- Future Features -->
        <h2 id="future">🔮 Future Features</h2>
        <ul>
            <li><strong>3D World Map 🌍:</strong> Interactive 3D globe for climb locations – zoom, explore perspectives with Three.js.</li>
            <li>Farcaster enhancements, NFTs, leaderboards, AR mobile app, mainnet.</li>
        </ul>
        <p>Open to angel investors – contact <a href="mailto:earvin.gallardo@csecsystems.com">Earvin Gallardo</a>.</p>

        <!-- Risks & Disclaimer -->
        <h2>⚠️ Risks & Disclaimer</h2>
        <p>Testnet only. No liability for damages. Proprietary – see <a href="https://github.com/EmpowerTours/version1/blob/main/LICENSE">License</a>.</p>

        <!-- License -->
        <h2>License</h2>
        <p>Earvin Gallardo owns the entity in its entirety, including all intellectual property rights. For licensing inquiries, investment opportunities, or permissions, contact <a href="mailto:earvin.gallardo@csecsystems.com">Earvin Gallardo</a> directly.<br>
        See full license at <a href="https://github.com/EmpowerTours/version1/blob/main/LICENSE">LICENSE</a>.</p>
        <p>© 2025 EmpowerTours. Built with xAI & Monad. Join the adventure! 🧗</p>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
    <script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
    <script>
        // Wallet Connect
        const userId = new URLSearchParams(window.location.search).get('userId');
        const apiBaseUrl = 'https://version1-production.up.railway.app';
        const statusDiv = document.getElementById('status');
        const errorDiv = document.getElementById('error');
        const txHashDiv = document.getElementById('txHash');
        let web3;
        let provider;
        let pollingInterval = null;
        let connectedAccount = null;
        const MONAD_TESTNET_CHAIN_ID = '0x27af'; // 10143 in hex
        const MONAD_TESTNET_CHAIN_ID_DECIMAL = 10143;
        const TOURS_TOKEN_ADDRESS = '0x2Da15A8B55BE310A7AB8EB0010506AB30CD6CBcf';
        const TOURS_ABI = [
            {
                "constant": true,
                "inputs": [{"name": "_owner", "type": "address"}],
                "name": "balanceOf",
                "outputs": [{"name": "balance", "type": "uint256"}],
                "type": "function"
            }
        ];

        async function initializeWeb3() {
            try {
                if (typeof Web3 === 'undefined') {
                    throw new Error('Web3.js library failed to load. Please refresh the page.');
                }
                if (window.ethereum) {
                    provider = window.ethereum;
                    web3 = new Web3(provider);
                } else if (window.WalletConnectProvider) {
                    provider = new window.WalletConnectProvider({
                        rpc: { 10143: 'https://testnet-rpc.monad.xyz' },
                        chainId: 10143,
                        qrcode: true
                    });
                    web3 = new Web3(provider);
                } else {
                    throw new Error('No wallet provider detected. Install MetaMask or use a Web3-compatible browser.');
                }
            } catch (error) {
                errorDiv.textContent = `Error initializing Web3: ${error.message}. On mobile, open this link in MetaMask’s browser (Menu > Browser). On desktop, install MetaMask.`;
                console.error('Web3 initialization error:', error);
                statusDiv.textContent = 'Please connect your wallet to Monad Testnet (chainId: 10143).';
                return false;
            }
            return true;
        }

        async function connectWallet() {
            errorDiv.textContent = '';
            statusDiv.textContent = 'Connecting...';
            console.log('Attempting to connect wallet for userId:', userId);
            if (!await initializeWeb3()) return;
            try {
                if (provider.isWalletConnect) {
                    await provider.enable();
                }
                const chainId = await web3.eth.getChainId();
                console.log('Current chain ID (decimal):', chainId);
                if (Number(chainId) !== MONAD_TESTNET_CHAIN_ID_DECIMAL) {
                    errorDiv.textContent = `Chain ID mismatch: expected 10143 (Monad Testnet), got ${chainId}. Please switch to Monad Testnet in MetaMask Settings > Networks.`;
                    console.warn('Chain ID mismatch detected:', chainId);
                    try {
                        await provider.request({
                            method: 'wallet_switchEthereumChain',
                            params: [{ chainId: MONAD_TESTNET_CHAIN_ID }],
                        });
                    } catch (switchError) {
                        if (switchError.code === 4902) {
                            await provider.request({
                                method: 'wallet_addEthereumChain',
                                params: [{
                                    chainId: MONAD_TESTNET_CHAIN_ID,
                                    chainName: 'Monad Testnet',
                                    rpcUrls: ['https://testnet-rpc.monad.xyz'],
                                    nativeCurrency: { name: 'MON', symbol: 'MON', decimals: 18 },
                                    blockExplorerUrls: ['https://testnet.monadexplorer.com']
                                }],
                            });
                        } else {
                            throw new Error(`Failed to switch chain: ${switchError.message}. Ensure Monad Testnet (chainId: 10143) is selected.`);
                        }
                    }
                }
                const accounts = await provider.request({ method: 'eth_requestAccounts' });
                connectedAccount = accounts[0];
                statusDiv.textContent = `Connected: ${connectedAccount.substring(0, 6)}... Use /createprofile, /buildaclimb, or /buyTours in Telegram to continue.`;
                console.log('Connected account:', connectedAccount);
                await submitWallet(connectedAccount);
                startPolling();
            } catch (error) {
                errorDiv.textContent = `Error connecting wallet: ${error.message}. Ensure Monad Testnet (chainId: 10143) is selected. On mobile, use MetaMask’s browser (Menu > Browser).`;
                console.error('Error connecting wallet:', error);
                statusDiv.textContent = 'Please connect your wallet to Monad Testnet (chainId: 10143).';
            }
        }

        async function submitWallet(account) {
            try {
                console.log('Submitting wallet for userId:', userId, 'address:', account);
                const response = await fetch(`${apiBaseUrl}/submit_wallet`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ userId, walletAddress: account })
                });
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${await response.text()}`);
                }
                statusDiv.textContent += ' Wallet submitted! Use /createprofile, /buildaclimb, or /buyTours in Telegram to continue.';
                console.log('Wallet submitted successfully');
            } catch (error) {
                errorDiv.textContent = `Error submitting wallet: ${error.message}. Try again or contact support at https://t.me/empowertourschat.`;
                console.error('Error submitting wallet:', error);
            }
        }

        async function pollTransaction() {
            if (!web3) {
                errorDiv.textContent = 'Web3 provider not initialized. Please reconnect your wallet.';
                console.error('Web3 not initialized');
                stopPolling();
                return;
            }
            try {
                console.log('Polling transaction for userId:', userId);
                const response = await fetch(`${apiBaseUrl}/get_transaction?userId=${userId}`);
                if (response.status === 404) {
                    statusDiv.textContent = 'No pending transaction. Initiate an action via Telegram (e.g., /buildaclimb).';
                    console.log('No pending transaction found');
                    stopPolling();
                    return;
                }
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${await response.text()}`);
                }
                const data = await response.json();
                if (data.transaction) {
                    stopPolling();
                    statusDiv.textContent = 'Transaction ready! Waiting for wallet to sign...';
                    console.log('Transaction data received:', data.transaction);
                    try {
                        const txResult = await web3.eth.sendTransaction(data.transaction);
                        const txHash = txResult.transactionHash;
                        statusDiv.textContent = `Transaction signed: ${txHash.substring(0, 6)}...`;
                        txHashDiv.textContent = `Transaction Hash: ${txHash}`;
                        console.log('Transaction signed, hash:', txHash);
                        await submitTransaction(txHash);
                        statusDiv.textContent = `Transaction submitted: ${txHash.substring(0, 6)}...`;
                        console.log('Transaction submitted to server');
                    } catch (error) {
                        errorDiv.textContent = `Error signing transaction: ${error.message}. Check parameters or contact support at https://t.me/empowertourschat.`;
                        console.error('Error signing transaction:', error);
                    }
                } else {
                    statusDiv.textContent = 'Waiting for transaction...';
                    console.log('No transaction data available yet');
                }
            } catch (error) {
                errorDiv.textContent = `Error polling transaction: ${error.message}. Try refreshing the page or contact support at https://t.me/empowertourschat.`;
                console.error('Error polling transaction:', error);
            }
        }

        async function submitTransaction(txHash) {
            try {
                console.log('Submitting transaction hash:', txHash);
                const response = await fetch(`${apiBaseUrl}/submit_tx`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ userId, txHash })
                });
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${await response.text()}`);
                }
                console.log('Transaction hash submitted successfully');
            } catch (error) {
                errorDiv.textContent = `Error submitting transaction: ${error.message}. Please send the transaction hash to the Telegram bot manually.`;
                console.error('Error submitting transaction:', error);
            }
        }

        async function checkBalance() {
            const resultElement = document.getElementById('balance-result');
            if (!web3 || !connectedAccount) {
                resultElement.textContent = 'Please connect your wallet first.';
                return;
            }
            try {
                // Fetch $MON balance
                const monBalance = await web3.eth.getBalance(connectedAccount);
                const monBalanceEther = web3.utils.fromWei(monBalance, 'ether');
                // Fetch $TOURS balance
                const toursContract = new web3.eth.Contract(TOURS_ABI, TOURS_TOKEN_ADDRESS);
                const toursBalance = await toursContract.methods.balanceOf(connectedAccount).call();
                const toursBalanceEther = web3.utils.fromWei(toursBalance, 'ether');
                resultElement.textContent = `Balance: ${parseFloat(monBalanceEther).toFixed(2)} $MON, ${parseFloat(toursBalanceEther).toFixed(2)} $TOURS`;
            } catch (error) {
                resultElement.textContent = `Error checking balance: ${error.message}`;
                console.error('Error checking balance:', error);
            }
        }

        function startPolling() {
            if (!pollingInterval) {
                console.log('Starting transaction polling');
                pollingInterval = setInterval(pollTransaction, 3000);
            }
        }

        function stopPolling() {
            if (pollingInterval) {
                console.log('Stopping transaction polling');
                clearInterval(pollingInterval);
                pollingInterval = null;
            }
        }

        // Hamburger Menu Toggle
        function toggleMenu() {
            const navMenu = document.getElementById('nav-menu');
            navMenu.classList.toggle('active');
        }

        // Smooth Scrolling and Map Interaction
        document.querySelectorAll('.header-nav a').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                const targetElement = document.getElementById(targetId);
                if (targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 80,
                        behavior: 'smooth'
                    });
                }
                const navMenu = document.getElementById('nav-menu');
                if (navMenu.classList.contains('active')) {
                    navMenu.classList.remove('active');
                }
            });
        });

        // Collapsible Section Persistence
        document.querySelectorAll('details').forEach(details => {
            const id = details.id;
            if (id) {
                const isOpen = localStorage.getItem(`details-${id}`) === 'true';
                details.open = isOpen;
                details.addEventListener('toggle', () => {
                    localStorage.setItem(`details-${id}`, details.open);
                });
            }
        });

        // Interactive Map
        async function loadClimbLocations() {
            try {
                const response = await fetch(`${apiBaseUrl}/find_climbs`);
                const data = await response.json();
                const climbs = data.climbs;
                const markersGroup = document.getElementById('climb-markers');
                const tooltip = document.getElementById('tooltip');
                climbs.forEach(climb => {
                    // Mock coordinates (since location is encrypted in backend)
                    const x = Math.random() * 900 + 50; // Random position on SVG
                    const y = Math.random() * 400 + 50;
                    const marker = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    marker.setAttribute('cx', x);
                    marker.setAttribute('cy', y);
                    marker.setAttribute('r', 5);
                    marker.setAttribute('class', 'climb-marker');
                    marker.addEventListener('mouseover', () => {
                        tooltip.style.display = 'block';
                        tooltip.textContent = `${climb.title}: ${climb.desc} (${climb.price} $TOURS)`;
                        tooltip.style.left = `${x}px`;
                        tooltip.style.top = `${y - 20}px`;
                    });
                    marker.addEventListener('mouseout', () => {
                        tooltip.style.display = 'none';
                    });
                    markersGroup.appendChild(marker);
                });
            } catch (error) {
                console.error('Error loading climb locations:', error);
            }
        }

        // Initialize
        window.addEventListener('load', async () => {
            if (userId) {
                console.log('Page loaded, initializing Web3 for userId:', userId);
                if (await initializeWeb3()) {
                    startPolling();
                    loadClimbLocations();
                }
            } else {
                errorDiv.textContent = 'Missing userId in URL. Use the link provided by /connectwallet in Telegram.';
                console.error('Missing userId in URL');
            }
        });

        // Google Translate Script
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({
                pageLanguage: 'en',
                includedLanguages: 'es,fr,de,zh-CN,ar,pt,ru,ja,it,ko',
                layout: google.translate.TranslateElement.InlineLayout.SIMPLE
            }, 'google_translate_element');
        }
    </script>
    <script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</body>
</html>
